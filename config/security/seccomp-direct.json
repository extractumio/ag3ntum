{
  "defaultAction": "SCMP_ACT_ALLOW",
  "architectures": [
    "SCMP_ARCH_X86_64",
    "SCMP_ARCH_X86",
    "SCMP_ARCH_AARCH64"
  ],
  "syscalls": [
    {
      "names": ["setuid", "setuid32", "setreuid", "setreuid32", "setresuid", "setresuid32", "setfsuid", "setfsuid32"],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "args": [
        {
          "index": 0,
          "value": 0,
          "op": "SCMP_CMP_EQ"
        }
      ],
      "comment": "CRITICAL: Block setuid to root (UID 0) unconditionally - NEVER allow"
    },
    {
      "names": ["setgid", "setgid32", "setregid", "setregid32", "setresgid", "setresgid32", "setfsgid", "setfsgid32"],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "args": [
        {
          "index": 0,
          "value": 0,
          "op": "SCMP_CMP_EQ"
        }
      ],
      "comment": "CRITICAL: Block setgid to root group (GID 0) unconditionally - NEVER allow"
    },
    {
      "names": ["setuid", "setuid32", "setreuid", "setreuid32", "setresuid", "setresuid32", "setfsuid", "setfsuid32"],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "args": [
        {
          "index": 0,
          "value": 999,
          "op": "SCMP_CMP_LE"
        }
      ],
      "comment": "Block setuid to system accounts (UID 1-999) - system users should never be used"
    },
    {
      "names": ["setgid", "setgid32", "setregid", "setregid32", "setresgid", "setresgid32", "setfsgid", "setfsgid32"],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "args": [
        {
          "index": 0,
          "value": 999,
          "op": "SCMP_CMP_LE"
        }
      ],
      "comment": "Block setgid to system groups (GID 1-999) - system groups should never be used"
    },
    {
      "names": ["setuid", "setuid32", "setreuid", "setreuid32", "setresuid", "setresuid32", "setfsuid", "setfsuid32"],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "args": [
        {
          "index": 0,
          "value": 65534,
          "op": "SCMP_CMP_GT"
        }
      ],
      "comment": "Block setuid to UIDs above normal user range (> 65534 = nobody/overflow)"
    },
    {
      "names": ["setgid", "setgid32", "setregid", "setregid32", "setresgid", "setresgid32", "setfsgid", "setfsgid32"],
      "action": "SCMP_ACT_ERRNO",
      "errnoRet": 1,
      "args": [
        {
          "index": 0,
          "value": 65534,
          "op": "SCMP_CMP_GT"
        }
      ],
      "comment": "Block setgid to GIDs above normal user range (> 65534 = nogroup/overflow)"
    }
  ],
  "_comment": "Seccomp profile for Ag3ntum DIRECT mode. Valid UID/GID range: [1000, 65533]. Root (0) and system accounts (1-999) are ALWAYS blocked. WARNING: This mode maps container UIDs directly to host UIDs. Use only when you understand the security implications."
}
